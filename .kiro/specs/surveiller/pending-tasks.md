# 未着手タスクリスト

このドキュメントは、`tasks.md` と `test-coverage-improvement-tasks.md` から未着手（`[ ]`）のタスクを抽出したものです。

最終更新: 2026-01-13

---

## 実装プラン (tasks.md) からの未着手タスク

### 1. プロジェクト構造とコアインターフェースの設定
- [ ] 1. プロジェクト構造とコアインターフェースの設定
  - Go モジュールの初期化と基本ディレクトリ構造の作成
  - 主要なインターフェース（Pinger, StateStore, Scheduler, ConfigParser）の定義
  - テストフレームワーク（gopter）の設定
  - _要件: 1.1, 2.1, 4.1_

### 4. ICMP Ping エンジンの実装
- [ ] 4. ICMP Ping エンジンの実装
- [ ] 4.1 Pinger インターフェースと ICMP 実装
  - golang.org/x/net/icmp を使用した ICMP ping 実装
  - PingResult 構造体とエラーハンドリング
  - _要件: 2.1, 2.5_

- [ ] 4.2 タイムアウト処理の実装
  - context.WithTimeout を使用したタイムアウト制御
  - タイムアウト時の失敗処理
  - _要件: 2.5_

- [ ]* 4.3 タイムアウト処理のプロパティテスト
  - **プロパティ 6: タイムアウト処理**
  - **検証対象: 要件 2.5**

### 5. 状態管理システムの実装
- [ ] 5. 状態管理システムの実装
- [ ] 5.1 StateStore インターフェースと実装
  - TargetStatus 構造体と状態遷移ロジック
  - スレッドセーフな状態更新機能
  - _要件: 2.2, 2.3, 2.4_

- [ ]* 5.2 ping 結果状態更新のプロパティテスト
  - **プロパティ 5: ping 結果の状態更新**
  - **検証対象: 要件 2.2, 2.3, 2.4**

- [ ] 5.3 RTT 履歴管理の実装
  - リングバッファによる RTT 履歴保持
  - 履歴サイズの制限と古いデータの削除
  - _要件: 5.5_

- [ ]* 5.4 履歴保持のプロパティテスト
  - **プロパティ 16: 履歴保持**
  - **検証対象: 要件 5.5**

- [ ] 5.5 動的設定更新機能の実装
  - ターゲット追加・削除時の状態管理
  - 既存ターゲットの履歴保持
  - _要件: 5.2, 5.3_

- [ ]* 5.6 動的設定更新のプロパティテスト
  - **プロパティ 14: 動的設定更新**
  - **検証対象: 要件 5.2, 5.3_

### 6. チェックポイント
- [ ] 6. チェックポイント - 基本機能のテスト確認
  - 全てのテストが通ることを確認し、問題があれば質問する

### 8. TUI システムの実装
- [ ] 8. TUI システムの実装
- [ ] 8.1 基本 TUI 構造の実装
  - bubbletea を使用した基本 TUI フレームワーク
  - ターゲット情報の表示レイアウト
  - _要件: 3.1_

- [ ] 8.2 グループ表示機能の実装
  - グループごとの区切り線表示
  - グループ名の表示
  - _要件: 3.2_

- [ ]* 8.3 TUI グループ表示のプロパティテスト
  - **プロパティ 7: TUI グループ表示**
  - **検証対象: 要件 3.2**

- [ ] 8.4 RTT バーグラフ表示の実装
  - RTT 値のバーグラフ描画
  - スケール設定による表示調整
  - _要件: 3.3_

- [ ]* 8.5 TUI RTT バーグラフ表示のプロパティテスト
  - **プロパティ 8: TUI RTT バーグラフ表示**
  - **検証対象: 要件 3.3**

- [ ] 8.6 リアルタイム更新機能の実装
  - 状態変化の即座な TUI 反映
  - キーボード入力処理（'q' キーでの終了）
  - _要件: 3.4, 3.5_

- [ ]* 8.7 TUI 状態更新のプロパティテスト
  - **プロパティ 9: TUI 状態更新の即時反映**
  - **検証対象: 要件 3.4**

### 9. ログシステムの実装
- [ ] 9. ログシステムの実装
- [ ] 9.1 構造化ログの実装
  - JSON 形式での構造化ログ出力
  - ログレベル制御機能
  - _要件: 6.1, 6.5_

- [ ] 9.2 イベントログ記録の実装
  - ping 結果のログ記録
  - 設定読み込みのログ記録
  - エラー情報のログ記録
  - _要件: 6.2, 6.3, 6.4_

- [ ]* 9.3 構造化ログ出力のプロパティテスト
  - **プロパティ 17: 構造化ログ出力**
  - **検証対象: 要件 6.1, 6.2, 6.3, 6.4, 6.5**

### 10. シグナルハンドリングの実装
- [ ] 10. シグナルハンドリングの実装
- [ ] 10.1 SIGHUP による設定リロード
  - シグナルハンドラーの実装
  - 設定ファイルの再読み込み機能
  - _要件: 5.1_

- [ ] 10.2 設定リロードエラー処理の実装
  - 無効な設定ファイルでのエラーハンドリング
  - 既存設定の維持機能
  - _要件: 5.4_

- [ ]* 10.3 設定リロードエラー処理のプロパティテスト
  - **プロパティ 15: 設定リロードエラー処理**
  - **検証対象: 要件 5.4**

### 11. メイン関数とアプリケーション統合
- [ ] 11. メイン関数とアプリケーション統合
- [ ] 11.1 main.go の実装
  - 全コンポーネントの初期化と統合
  - アプリケーションライフサイクルの管理
  - _要件: 全体統合_

- [ ] 11.2 エラーハンドリングの統合
  - ICMP 権限不足時のエラー処理
  - 適切なエラーメッセージとヘルプ表示
  - _要件: 7.5_

### 12. 最終チェックポイント
- [ ] 12. 最終チェックポイント - 全機能テスト
  - 全てのテストが通ることを確認し、問題があれば質問する

---

## テストカバレッジ向上タスク (test-coverage-improvement-tasks.md) からの未着手タスク

### 中優先度: 不足している正確性プロパティテスト

- [ ]* 5.3 TUI グループ表示のプロパティテスト
  - **プロパティ 7: TUI グループ表示**
  - **検証対象: 要件 3.2**

- [ ]* 5.5 TUI RTT バーグラフ表示のプロパティテスト
  - **プロパティ 8: TUI RTT バーグラフ表示**
  - **検証対象: 要件 3.3**

- [ ]* 5.6 TUI 状態更新のプロパティテスト
  - **プロパティ 9: TUI 状態更新の即時反映**
  - **検証対象: 要件 3.4**

### 低優先度: 統合テストとエンドツーエンドテスト

- [ ] 6. main パッケージの統合テスト
- [ ] 6.1 アプリケーション初期化の単体テスト
  - CLI オプション解析とオーバーライド処理
  - 設定ファイル読み込み処理
  - コンポーネント初期化処理
  - _要件: 全体統合_

- [ ] 6.2 シグナルハンドリングの単体テスト
  - SIGHUP による設定リロード
  - SIGINT/SIGTERM による適切な終了
  - _要件: 5.1, 4.4_

- [ ]* 6.3 設定リロードエラー処理のプロパティテスト
  - **プロパティ 15: 設定リロードエラー処理**
  - **検証対象: 要件 5.4**

- [ ]* 6.4 構造化ログ出力のプロパティテスト
  - **プロパティ 17: 構造化ログ出力**
  - **検証対象: 要件 6.1, 6.2, 6.3, 6.4, 6.5**

- [ ] 7. エンドツーエンド統合テスト
- [ ] 7.1 設定ファイルから監視開始までの統合テスト
  - 設定ファイル読み込み → スケジューラー起動 → ping 実行の流れ
  - _要件: 1.1, 2.1, 4.1_

- [ ] 7.2 TUI とバックエンドの統合テスト
  - 状態更新 → TUI 表示更新の流れ
  - キーボード入力処理
  - _要件: 3.1, 3.4, 3.5_

- [ ] 7.3 設定リロードの統合テスト
  - SIGHUP → 設定再読み込み → 監視更新の流れ
  - _要件: 5.1, 5.2, 5.3_

### 特別タスク: テストカバレッジ向上のための改善

- [ ] 8. テストカバレッジ測定とレポート改善
- [ ] 8.1 カバレッジレポートの自動生成
  - HTML カバレッジレポートの CI 統合
  - カバレッジ閾値の設定（目標: 85%以上）

- [ ] 8.2 未カバー部分の特定と対応
  - エラーハンドリング分岐のテスト追加
  - エッジケースのテスト追加

- [ ] 8.3 テストヘルパー関数の整備
  - モック pinger の改善
  - テスト用設定ファイル生成ヘルパー
  - テスト用 TUI 環境の構築

---

## タスク統計

### 実装プラン (tasks.md)
- **未着手タスク数**: 32個
  - 実装タスク: 20個
  - プロパティテスト: 7個
  - チェックポイント: 2個

### テストカバレッジ向上タスク (test-coverage-improvement-tasks.md)
- **未着手タスク数**: 10個
  - プロパティテスト: 5個
  - 統合テスト: 4個
  - 改善タスク: 3個

### 合計
- **総未着手タスク数**: 42個

---

## 注意事項

- `*` マークのタスクはプロパティベーステストのため、実行時間が長くなる可能性があります
- プロパティテストは `gopter` ライブラリを使用し、最低100回の反復が必要です
- ネットワーク関連のテストは適切なモックを使用し、実際のネットワーク通信は避けてください
- TUI のテストは tcell のテスト機能を活用し、実際の端末出力は避けてください

---

## 優先度の高いタスク（推奨順）

1. **4. ICMP Ping エンジンの実装** - コア機能の実装
2. **5. 状態管理システムの実装** - データ管理の基盤
3. **8. TUI システムの実装** - ユーザーインターフェース
4. **10. シグナルハンドリングの実装** - 設定リロード機能
5. **11. メイン関数とアプリケーション統合** - 全体統合
6. **9. ログシステムの実装** - 運用に必要な機能
